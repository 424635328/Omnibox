# ğŸ¨ Omnibox Frontend (Vue 3 UI)

Omnibox çš„ç”¨æˆ·ç•Œé¢å±‚ï¼Œé‡‡ç”¨ **[Vue 3](https://vuejs.org/)** + **[TypeScript](https://www.typescriptlang.org/)** + **[Vite](https://vitejs.dev/)** æ„å»ºã€‚

å®ƒè´Ÿè´£æä¾›ç±»ä¼¼ macOS Spotlight æˆ– Raycast çš„ä¸æ»‘äº¤äº’ä½“éªŒï¼ŒåŒ…æ‹¬è™šæ‹Ÿæ»šåŠ¨ã€é”®ç›˜å¯¼èˆªã€è®¾ç½®é¢æ¿ä»¥åŠä¸ Rust åç«¯çš„é«˜æ•ˆé€šä¿¡ã€‚è®¾è®¡å“²å­¦æ˜¯ï¼š**æç®€ä¸»ä¹‰ã€æ— å¹²æ‰°ã€å“åº”å¼**ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

*   **âš¡ æè‡´æ€§èƒ½**:
    *   **æ»šè½®é˜²æŠ– (Scroll Lock)**: æ™ºèƒ½åˆ¤æ–­ç”¨æˆ·æ˜¯åœ¨â€œæµè§ˆâ€è¿˜æ˜¯â€œé€‰æ‹©â€ï¼Œè§£å†³æ»šåŠ¨æ—¶é€‰ä¸­é¡¹ä¹±è·³çš„é—®é¢˜ã€‚
    *   **è™šæ‹Ÿæ»šåŠ¨ä¼˜åŒ–**: å³ä½¿åç«¯è¿”å› 500 æ¡ç»“æœï¼Œåˆ—è¡¨æ¸²æŸ“ä¾ç„¶æµç•…ã€‚
*   **âŒ¨ï¸ é”®ç›˜ä¼˜å…ˆ (Keyboard First)**:
    *   å…¨é”®ç›˜å¯¼èˆª (`â†‘` `â†“` é€‰æ‹©ï¼Œ`Enter` æ‰“å¼€ï¼Œ`Esc` éšè—)ã€‚
    *   æœç´¢ç»“æœè‡ªåŠ¨é«˜äº®åŒ¹é…å­—ç¬¦ã€‚
*   **ğŸ¨ ç°ä»£ UI è®¾è®¡**:
    *   **Acrylic / Glassmorphism**: æ·±åº¦æ¯›ç»ç’ƒèƒŒæ™¯ï¼Œå®Œç¾èåˆç³»ç»Ÿæ¡Œé¢ã€‚
    *   **Overlay Scrollbar**: æ‚¬æµ®å¼æ»šåŠ¨æ¡ï¼Œä¸å ç”¨å¸ƒå±€ç©ºé—´ã€‚
    *   **Vector Icons**: é›†æˆ `lucide-vue-next` çŸ¢é‡å›¾æ ‡åº“ï¼Œæ ¹æ®æ–‡ä»¶ç±»å‹åŠ¨æ€æ˜¾ç¤ºå›¾æ ‡ã€‚
*   **âš™ï¸ åŠ¨æ€è®¾ç½®é¢æ¿**: æ— éœ€é‡å¯ï¼Œå³æ—¶è°ƒæ•´æœ€å¤§ç»“æœæ•°å’Œå¼€æœºè‡ªå¯çŠ¶æ€ã€‚

## ğŸ›  æŠ€æœ¯æ ˆ

| ç»„ä»¶ | æŠ€æœ¯/åº“ | ç”¨é€” |
| :--- | :--- | :--- |
| **Framework** | Vue 3 (Composition API) | å“åº”å¼ UI æ¡†æ¶ |
| **Language** | TypeScript | ç±»å‹å®‰å…¨ä¸ä»£ç å¥å£®æ€§ |
| **Build Tool** | Vite | æé€Ÿ HMR å¼€å‘ä¸æ„å»º |
| **Bridge** | `@tauri-apps/api` | è°ƒç”¨ Rust åç«¯æŒ‡ä»¤ |
| **Icons** | `lucide-vue-next` | è½»é‡çº§ React/Vue å›¾æ ‡åº“ |
| **Styles** | CSS Variables + Flexbox | åŸç”Ÿ CSS å®ç°ä¸»é¢˜ä¸å¸ƒå±€ |

## ğŸ“‚ é¡¹ç›®ç»“æ„

```text
frontend/
â”œâ”€â”€ index.html          # å…¥å£ HTML
â”œâ”€â”€ vite.config.ts      # Vite é…ç½® (ç«¯å£å›ºå®š 1420)
â”œâ”€â”€ tsconfig.json       # TypeScript é…ç½®
â””â”€â”€ src/
    â”œâ”€â”€ main.ts         # Vue åº”ç”¨æŒ‚è½½ç‚¹
    â”œâ”€â”€ App.vue         # æ ¸å¿ƒç»„ä»¶ (åŒ…å«æ‰€æœ‰é€»è¾‘ä¸æ ·å¼)
    â””â”€â”€ assets/         # é™æ€èµ„æº
```

## ğŸš€ å¼€å‘æŒ‡å—

### 1. å®‰è£…ä¾èµ–
```bash
npm install
# ç¡®ä¿å®‰è£…äº† tauri api çš„ v1 ç‰ˆæœ¬ (å¦‚æœåç«¯æ˜¯ v1)
npm install @tauri-apps/api@^1.6.0
```

### 2. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
```bash
npm run dev
# æœåŠ¡å°†åœ¨ http://localhost:1420 å¯åŠ¨
# æ³¨æ„ï¼šå‰ç«¯æ— æ³•ç‹¬ç«‹è¿è¡Œæ ¸å¿ƒåŠŸèƒ½ï¼Œå¿…é¡»é…åˆ `cargo run` å¯åŠ¨åç«¯æ‰èƒ½è°ƒç”¨ API
```

### 3. æ„å»ºç”Ÿäº§ç‰ˆæœ¬
```bash
npm run build
# æ„å»ºäº§ç‰©å°†è¾“å‡ºåˆ° dist/ ç›®å½•ï¼Œä¾› Tauri åç«¯æ‰“åŒ…ä½¿ç”¨
```

## ğŸ§© æ ¸å¿ƒé€»è¾‘è§£æ (`App.vue`)

### 1. é€šä¿¡æ¡¥æ¥ (Bridge)
å‰ç«¯é€šè¿‡ `invoke` å‡½æ•°å‘ Rust å‘é€æŒ‡ä»¤ï¼Œé€šè¿‡ `listen` ç›‘å¬ç³»ç»Ÿäº‹ä»¶ã€‚
```typescript
import { invoke } from "@tauri-apps/api/tauri";
import { listen } from "@tauri-apps/api/event";

// è°ƒç”¨æœç´¢
const results = await invoke("search", { query: "cmd" });

// ç›‘å¬çª—å£å”¤é†’ (Alt+Space)
await listen("window-focused", () => {
  // è‡ªåŠ¨èšç„¦è¾“å…¥æ¡†ï¼Œé‡ç½®åˆ—è¡¨
  searchInput.value?.focus();
});
```

### 2. æ™ºèƒ½äº¤äº’é” (Interaction Locks)
ä¸ºäº†è§£å†³é¼ æ ‡æ»šè½®ä¸ `mousemove` äº‹ä»¶çš„å†²çªï¼Œæˆ‘ä»¬å¼•å…¥äº†çŠ¶æ€é”ï¼š
```typescript
const isKeyboardScroll = ref(false); // é”®ç›˜æ“ä½œæ—¶ï¼Œå…è®¸è‡ªåŠ¨æ»šåŠ¨è§†å›¾
const isMouseScrolling = ref(false); // é¼ æ ‡æ»šè½®æ»šåŠ¨æ—¶ï¼Œç¦ç”¨ hover é«˜äº®

// å½“æ£€æµ‹åˆ° scroll äº‹ä»¶æ—¶ï¼Œæš‚æ—¶ç¦ç”¨ mousemove å¤„ç†é€»è¾‘ 150ms
const handleListScroll = () => {
  isMouseScrolling.value = true;
  // ... clearTimeout & setTimeout logic
};
```

### 3. å…³é”®è¯é«˜äº® (Highlighting)
ä½¿ç”¨æ­£åˆ™æ›¿æ¢å°†åŒ¹é…çš„å­—ç¬¦åŒ…è£¹åœ¨ `<span class="highlight">` ä¸­ï¼š
```typescript
const highlightText = (text: string, keyword: string) => {
  const safeKeyword = keyword.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'); // è½¬ä¹‰æ­£åˆ™ç¬¦å·
  const regex = new RegExp(`(${safeKeyword})`, "gi");
  return text.replace(regex, '<span class="highlight">$1</span>');
};
```

## ğŸ¨ æ ·å¼å®šåˆ¶ (CSS Variables)

æ‰€æœ‰æ ¸å¿ƒé¢œè‰²å‡å®šä¹‰åœ¨ `:root` ä¸­ï¼Œæ–¹ä¾¿æœªæ¥æ”¯æŒæš—é»‘/æ˜äº®æ¨¡å¼åˆ‡æ¢ã€‚

```css
:root {
  --bg-color: rgba(30, 30, 35, 0.95);      /* ä¸»èƒŒæ™¯ (æ·±è‰²) */
  --accent-color: #3b82f6;                 /* å¼ºè°ƒè‰² (è“) */
  --selected-bg: rgba(255, 255, 255, 0.08);/* é€‰ä¸­é¡¹èƒŒæ™¯ */
  --text-primary: #ffffff;
  --text-secondary: #a1a1aa;
}
```

## âš™ï¸ è®¾ç½®é¢æ¿

è®¾ç½®é¢æ¿æ˜¯ä¸€ä¸ªè¦†ç›–å±‚ (Overlay)ï¼Œé€šè¿‡ `v-if="showSettings"` æ§åˆ¶æ˜¾ç¤ºã€‚
*   **Max Results**: è¾“å…¥æ•°å­—ç›´æ¥ç»‘å®šåˆ° `settings.max_results`ã€‚
*   **Launch at Startup**: å¼€å…³ç»„ä»¶ç»‘å®šåˆ° `settings.enable_autostart`ã€‚
*   **ä¿å­˜é€»è¾‘**: ç‚¹å‡» Save æ—¶ï¼Œå°†æ•´ä¸ªè®¾ç½®å¯¹è±¡ä¼ å›åç«¯ `save_settings` æ¥å£ï¼Œåç«¯è´Ÿè´£å†™å…¥ç£ç›˜å’Œæ³¨å†Œæ³¨å†Œè¡¨ã€‚

## ğŸ“ å¸¸è§é—®é¢˜

**Q: ä¸ºä»€ä¹ˆå›¾æ ‡æŠ¥é”™ `ArrowUp is declared but never read`?**
A: TypeScript æ£€æŸ¥éå¸¸ä¸¥æ ¼ã€‚å¦‚æœå¼•å…¥äº†å›¾æ ‡ä½†åœ¨ `<template>` ä¸­æ²¡ä½¿ç”¨ï¼Œæ„å»ºä¼šå¤±è´¥ã€‚è¯·åˆ é™¤ `import` è¯­å¥ä¸­æœªä½¿ç”¨çš„å›¾æ ‡åç§°ã€‚

**Q: æ»šåŠ¨æ¡ä¸ºä»€ä¹ˆä¸æ˜¾ç¤ºï¼Ÿ**
A: åªæœ‰å½“ç»“æœæ•°é‡è¶…è¿‡çª—å£é«˜åº¦æ—¶æ‰ä¼šæ˜¾ç¤ºã€‚è¯·åœ¨è®¾ç½®ä¸­å°† "Max Results" è°ƒå¤§ï¼ˆå¦‚ 100ï¼‰ï¼Œå¹¶ç¡®ä¿ CSS ä¸­ `.result-area` è®¾ç½®äº† `overflow-y: auto` æˆ– `overlay`ã€‚

**Q: ä¸ºä»€ä¹ˆè¾“å…¥æ¡†ä¸èƒ½è¾“å…¥ä¸­æ–‡ï¼Ÿ**
A: Tauri åœ¨æŸäº› Windows ç‰ˆæœ¬ä¸‹å¯¹ IME è¾“å…¥æ³•çš„æ”¯æŒå¯èƒ½éœ€è¦è°ƒæ•´ã€‚ç›®å‰çš„å®ç°ä½¿ç”¨äº†æ ‡å‡†çš„ HTML `<input>`ï¼Œé€šå¸¸æ˜¯æ”¯æŒçš„ã€‚å¦‚æœé‡åˆ°é—®é¢˜ï¼Œå°è¯•åœ¨ `tauri.conf.json` ä¸­è°ƒæ•´çª—å£ç„¦ç‚¹ç­–ç•¥ã€‚

---

Â© 2023 Omnibox Project. Built with â¤ï¸ and Vue 3.